\hypertarget{class_grid}{}\section{Grid Class Reference}
\label{class_grid}\index{Grid@{Grid}}


Class representing grid on which E and B fields and currents are defined.  




{\ttfamily \#include $<$grid.\+hpp$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_grid_a696a4b0b7335bed4b9b712e72eb1034e}{}\label{class_grid_a696a4b0b7335bed4b9b712e72eb1034e} 
{\bfseries Grid} (int $\ast$nxyz, int n\+Ghosts, double $\ast$xyz0, double $\ast$Lxyz)
\item 
int \hyperlink{class_grid_ab1cc80fe3a856f09d59b51ef558764c3}{evolve\+Fields} (double dt)
\begin{DoxyCompactList}\small\item\em Evolve Electric and Magnetic fields in time. \end{DoxyCompactList}\item 
int \hyperlink{class_grid_a93ea3ff4d2e7bdc9b5c4cbe9fe604f76}{get\+Field\+Interpolator\+Vec} (int cell\+ID, double $\ast$Interpolator\+Vec)
\begin{DoxyCompactList}\small\item\em Return vector for field interpolation. \end{DoxyCompactList}\item 
int \hyperlink{class_grid_a7347c885ddb7abbcc9390b6fec4ba42b}{get\+Cell\+ID} (double x, double y, double z)
\begin{DoxyCompactList}\small\item\em Get cell ID based on particle position. \end{DoxyCompactList}\item 
\hypertarget{class_grid_a2bf56b3564559d4ac6533ee5610dc2ca}{}\label{class_grid_a2bf56b3564559d4ac6533ee5610dc2ca} 
int \hyperlink{class_grid_a2bf56b3564559d4ac6533ee5610dc2ca}{get\+Number\+Of\+Cells} ()
\begin{DoxyCompactList}\small\item\em Get total number of cells. \end{DoxyCompactList}\item 
double \hyperlink{class_grid_a7c37daac383190622c7cf37597101510}{get\+Step\+Size} (int dimension)
\begin{DoxyCompactList}\small\item\em Get number of cells along dimension in grid. \end{DoxyCompactList}\item 
\hypertarget{class_grid_ae677a62490f6c432895e2ac38e9c0ef8}{}\label{class_grid_ae677a62490f6c432895e2ac38e9c0ef8} 
void {\bfseries update\+Ghost\+Cells} ()
\item 
\hypertarget{class_grid_a3ec170bd98cf658e567ac0d6a4975ceb}{}\label{class_grid_a3ec170bd98cf658e567ac0d6a4975ceb} 
int {\bfseries get\+Ghost\+Vec\+Size} ()
\item 
\hypertarget{class_grid_a768ae91746ecfc1d7b9172c431ecf45c}{}\label{class_grid_a768ae91746ecfc1d7b9172c431ecf45c} 
void {\bfseries get\+Ghost\+Vec} (const int side, double $\ast$ghost\+Vec)
\item 
\hypertarget{class_grid_a606fe5333db63f24d270a0546608f1f4}{}\label{class_grid_a606fe5333db63f24d270a0546608f1f4} 
void {\bfseries get\+Ghost\+Vec\+Alt} (const int side, double $\ast$ghost\+Vec)
\item 
\hypertarget{class_grid_aa24065a7d9fedd06cdb78a4c81c44b79}{}\label{class_grid_aa24065a7d9fedd06cdb78a4c81c44b79} 
void {\bfseries set\+Ghost\+Vec} (const int side, const double $\ast$ghost\+Vec)
\item 
\hypertarget{class_grid_a5d47f8db0c280c26467b5a91465b7d40}{}\label{class_grid_a5d47f8db0c280c26467b5a91465b7d40} 
void {\bfseries set\+Ghost\+Vec\+Alt} (const int side, const double $\ast$ghost\+Vec)
\item 
\hypertarget{class_grid_ab6866ceb9a38b1b68d587db5cd343bba}{}\label{class_grid_ab6866ceb9a38b1b68d587db5cd343bba} 
double {\bfseries getx0} ()
\item 
\hypertarget{class_grid_abde253b5f588c41e5fef6151052ca2ab}{}\label{class_grid_abde253b5f588c41e5fef6151052ca2ab} 
double {\bfseries gety0} ()
\item 
\hypertarget{class_grid_a0e89654502e992253544fc200387272b}{}\label{class_grid_a0e89654502e992253544fc200387272b} 
double {\bfseries getz0} ()
\item 
\hypertarget{class_grid_a800957fe9d9d5ea65ee324fec80351af}{}\label{class_grid_a800957fe9d9d5ea65ee324fec80351af} 
double {\bfseries getdx} ()
\item 
\hypertarget{class_grid_af8a59161f00b54b18f9a472447cfdca4}{}\label{class_grid_af8a59161f00b54b18f9a472447cfdca4} 
double {\bfseries getdy} ()
\item 
\hypertarget{class_grid_afd9f90b7b01e8bf072f0328c9683927c}{}\label{class_grid_afd9f90b7b01e8bf072f0328c9683927c} 
double {\bfseries getdz} ()
\item 
\hypertarget{class_grid_a79f8ff349630daeab0928c5295160789}{}\label{class_grid_a79f8ff349630daeab0928c5295160789} 
double {\bfseries get\+Lx} ()
\item 
\hypertarget{class_grid_a4b845844084784e1feaec7d606aa1298}{}\label{class_grid_a4b845844084784e1feaec7d606aa1298} 
double {\bfseries get\+Ly} ()
\item 
\hypertarget{class_grid_a8b159f067d2b3df26aebbf5408c90fc1}{}\label{class_grid_a8b159f067d2b3df26aebbf5408c90fc1} 
double {\bfseries get\+Lz} ()
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_grid_a23877f79f95e9a109e908d930c8036b4}{}\label{class_grid_a23877f79f95e9a109e908d930c8036b4} 
double $\ast$$\ast$$\ast$ {\bfseries new\+Field\+\_\+} ()
\item 
\hypertarget{class_grid_acaa1c3843fd96478b3a5e9f62401d8e0}{}\label{class_grid_acaa1c3843fd96478b3a5e9f62401d8e0} 
void {\bfseries delete\+Field\+\_\+} (double $\ast$$\ast$$\ast$field\+Pt)
\item 
\hypertarget{class_grid_a91fc198085fdfeaa6378a99db4dbc6ac}{}\label{class_grid_a91fc198085fdfeaa6378a99db4dbc6ac} 
int {\bfseries side\+To\+Index\+\_\+} (const int side)
\item 
\hypertarget{class_grid_adfae48e6068488739c8823bc575f4f0a}{}\label{class_grid_adfae48e6068488739c8823bc575f4f0a} 
void {\bfseries slice\+Mat\+To\+Vec\+\_\+} (double $\ast$$\ast$$\ast$const mat, const int side)
\item 
\hypertarget{class_grid_a99b9c649ef28f41fa939d4517f504eb0}{}\label{class_grid_a99b9c649ef28f41fa939d4517f504eb0} 
void {\bfseries unslice\+Mat\+To\+Vec\+\_\+} (double $\ast$$\ast$$\ast$mat, const int side)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_grid_af1915aaf156bbc0677d2f8853643fddb}{}\label{class_grid_af1915aaf156bbc0677d2f8853643fddb} 
const int {\bfseries nx\+\_\+}
\item 
\hypertarget{class_grid_a017c2ce200149e3f6b9e1feec7432be3}{}\label{class_grid_a017c2ce200149e3f6b9e1feec7432be3} 
const int {\bfseries ny\+\_\+}
\item 
\hypertarget{class_grid_af66fb5b609dbae6a5c47db6a3726a109}{}\label{class_grid_af66fb5b609dbae6a5c47db6a3726a109} 
const int {\bfseries nz\+\_\+}
\item 
\hypertarget{class_grid_a98debafd3794f12c96db014d5a81eaba}{}\label{class_grid_a98debafd3794f12c96db014d5a81eaba} 
const int {\bfseries n\+Ghosts\+\_\+}
\item 
\hypertarget{class_grid_aace2e7b11d2a22c87ea16b532e6c20a4}{}\label{class_grid_aace2e7b11d2a22c87ea16b532e6c20a4} 
const double {\bfseries x0\+\_\+}
\item 
\hypertarget{class_grid_a68796bd5f9418d0777516b19871a77bd}{}\label{class_grid_a68796bd5f9418d0777516b19871a77bd} 
const double {\bfseries y0\+\_\+}
\item 
\hypertarget{class_grid_a6532d09f92dfa370d11e302a6a3eff9a}{}\label{class_grid_a6532d09f92dfa370d11e302a6a3eff9a} 
const double {\bfseries z0\+\_\+}
\item 
\hypertarget{class_grid_a2ee01f81fd767620cfcae164be951713}{}\label{class_grid_a2ee01f81fd767620cfcae164be951713} 
const double {\bfseries Lx\+\_\+}
\item 
\hypertarget{class_grid_a7cd0a2a18b5f0d063984da365de2d893}{}\label{class_grid_a7cd0a2a18b5f0d063984da365de2d893} 
const double {\bfseries Ly\+\_\+}
\item 
\hypertarget{class_grid_afb8df0a51563cb751ccd94cc29b69e7a}{}\label{class_grid_afb8df0a51563cb751ccd94cc29b69e7a} 
const double {\bfseries Lz\+\_\+}
\item 
\hypertarget{class_grid_a168dc221b038fa0130606ddba9281534}{}\label{class_grid_a168dc221b038fa0130606ddba9281534} 
const int {\bfseries i\+Beg\+\_\+}
\item 
\hypertarget{class_grid_ac7599170601ea6b6d1a7d6c4b671b24c}{}\label{class_grid_ac7599170601ea6b6d1a7d6c4b671b24c} 
const int {\bfseries j\+Beg\+\_\+}
\item 
\hypertarget{class_grid_a9a3b3086af10cf5e3e3d9136e8082d3b}{}\label{class_grid_a9a3b3086af10cf5e3e3d9136e8082d3b} 
const int {\bfseries k\+Beg\+\_\+}
\item 
\hypertarget{class_grid_a5a93654972769d0c6167501b72e47a8a}{}\label{class_grid_a5a93654972769d0c6167501b72e47a8a} 
const int {\bfseries i\+End\+\_\+}
\item 
\hypertarget{class_grid_ab7f65f3bf13b95fff3f0d2317078a185}{}\label{class_grid_ab7f65f3bf13b95fff3f0d2317078a185} 
const int {\bfseries j\+End\+\_\+}
\item 
\hypertarget{class_grid_af73398f1f22f32beb71081b33eb7aa88}{}\label{class_grid_af73398f1f22f32beb71081b33eb7aa88} 
const int {\bfseries k\+End\+\_\+}
\item 
\hypertarget{class_grid_a63a64dc2ea909ee51cd0a4cd00a3fb11}{}\label{class_grid_a63a64dc2ea909ee51cd0a4cd00a3fb11} 
const double {\bfseries dx\+\_\+}
\item 
\hypertarget{class_grid_a210cf6638f34de1854c4430905d44401}{}\label{class_grid_a210cf6638f34de1854c4430905d44401} 
const double {\bfseries dy\+\_\+}
\item 
\hypertarget{class_grid_a88975e0c193ba200d3bb20d1b7f5aa08}{}\label{class_grid_a88975e0c193ba200d3bb20d1b7f5aa08} 
const double {\bfseries dz\+\_\+}
\item 
\hypertarget{class_grid_a873f5a0ef0ef52b485a3b38237c3e916}{}\label{class_grid_a873f5a0ef0ef52b485a3b38237c3e916} 
const int {\bfseries n\+Real\+Pts\+Y\+Z\+Plane\+\_\+}
\item 
\hypertarget{class_grid_a2bae6b711883328cddf69d37af10732c}{}\label{class_grid_a2bae6b711883328cddf69d37af10732c} 
const int {\bfseries n\+Fields\+\_\+}
\item 
\hypertarget{class_grid_a4c757d84f22696e88a4c500e35742ee2}{}\label{class_grid_a4c757d84f22696e88a4c500e35742ee2} 
const int {\bfseries ghost\+Vec\+Size\+\_\+}
\item 
\hypertarget{class_grid_a4f82b7703c89f4d202a636b77619cc4f}{}\label{class_grid_a4f82b7703c89f4d202a636b77619cc4f} 
double $\ast$$\ast$$\ast$ {\bfseries Ex\+\_\+}
\item 
\hypertarget{class_grid_a29021cc53090316898144ee2987b3b3f}{}\label{class_grid_a29021cc53090316898144ee2987b3b3f} 
double $\ast$$\ast$$\ast$ {\bfseries Ey\+\_\+}
\item 
\hypertarget{class_grid_ae258f0a77f3324405298f756c44995d6}{}\label{class_grid_ae258f0a77f3324405298f756c44995d6} 
double $\ast$$\ast$$\ast$ {\bfseries Ez\+\_\+}
\item 
\hypertarget{class_grid_af3e410cb198880388039e4a49a9bc55d}{}\label{class_grid_af3e410cb198880388039e4a49a9bc55d} 
double $\ast$$\ast$$\ast$ {\bfseries Bx\+\_\+}
\item 
\hypertarget{class_grid_acbb9cb3b41fbff9958955e92a42efe58}{}\label{class_grid_acbb9cb3b41fbff9958955e92a42efe58} 
double $\ast$$\ast$$\ast$ {\bfseries By\+\_\+}
\item 
\hypertarget{class_grid_ad2cec062b407c6ac77d5aac144c71258}{}\label{class_grid_ad2cec062b407c6ac77d5aac144c71258} 
double $\ast$$\ast$$\ast$ {\bfseries Bz\+\_\+}
\item 
\hypertarget{class_grid_a5310eeec619f3f8ec782fd3a1757d29e}{}\label{class_grid_a5310eeec619f3f8ec782fd3a1757d29e} 
double $\ast$$\ast$$\ast$ {\bfseries Bx\+\_\+tm1\+\_\+}
\item 
\hypertarget{class_grid_a8febeb882155e2d76b15d4279c52698d}{}\label{class_grid_a8febeb882155e2d76b15d4279c52698d} 
double $\ast$$\ast$$\ast$ {\bfseries By\+\_\+tm1\+\_\+}
\item 
\hypertarget{class_grid_a90815801f8c229cfd47da1566b36e57d}{}\label{class_grid_a90815801f8c229cfd47da1566b36e57d} 
double $\ast$$\ast$$\ast$ {\bfseries Bz\+\_\+tm1\+\_\+}
\item 
\hypertarget{class_grid_a8d4ca4b13f4d3963bd8e78c48e527fc8}{}\label{class_grid_a8d4ca4b13f4d3963bd8e78c48e527fc8} 
double $\ast$$\ast$$\ast$ {\bfseries Jx\+\_\+}
\item 
\hypertarget{class_grid_a320132efacf9d773c82a97c2f838cb06}{}\label{class_grid_a320132efacf9d773c82a97c2f838cb06} 
double $\ast$$\ast$$\ast$ {\bfseries Jy\+\_\+}
\item 
\hypertarget{class_grid_ade5d55b0ce8f87a22ce8bf18047486a4}{}\label{class_grid_ade5d55b0ce8f87a22ce8bf18047486a4} 
double $\ast$$\ast$$\ast$ {\bfseries Jz\+\_\+}
\item 
\hypertarget{class_grid_a5dcd38dc5d89c1a2a22af25b34998a63}{}\label{class_grid_a5dcd38dc5d89c1a2a22af25b34998a63} 
double $\ast$ {\bfseries slice\+Tmp\+\_\+}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Class representing grid on which E and B fields and currents are defined. 

\hyperlink{class_grid}{Grid} has ghost cells on each face. The ghost cell updating in y and z arises from periodic boundary conditions. x-\/direction ghost cells allow communication between M\+PI domains.

Following Yee (1966), electric fields and currents reside on edges, and magnetic fields on faces. Fields are updated using a set of finite-\/difference equations approximating Ampere\textquotesingle{}s and Faraday\textquotesingle{}s Laws.

A set of getters are available to allow particles to interpolate electric fields based on their position. 

\subsection{Member Function Documentation}
\hypertarget{class_grid_ab1cc80fe3a856f09d59b51ef558764c3}{}\label{class_grid_ab1cc80fe3a856f09d59b51ef558764c3} 
\index{Grid@{Grid}!evolve\+Fields@{evolve\+Fields}}
\index{evolve\+Fields@{evolve\+Fields}!Grid@{Grid}}
\subsubsection{\texorpdfstring{evolve\+Fields()}{evolveFields()}}
{\footnotesize\ttfamily int Grid\+::evolve\+Fields (\begin{DoxyParamCaption}\item[{double}]{dt }\end{DoxyParamCaption})}



Evolve Electric and Magnetic fields in time. 

Uses Yee algorithm to advance E and B fields. \hypertarget{class_grid_a7347c885ddb7abbcc9390b6fec4ba42b}{}\label{class_grid_a7347c885ddb7abbcc9390b6fec4ba42b} 
\index{Grid@{Grid}!get\+Cell\+ID@{get\+Cell\+ID}}
\index{get\+Cell\+ID@{get\+Cell\+ID}!Grid@{Grid}}
\subsubsection{\texorpdfstring{get\+Cell\+I\+D()}{getCellID()}}
{\footnotesize\ttfamily int Grid\+::get\+Cell\+ID (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{double}]{y,  }\item[{double}]{z }\end{DoxyParamCaption})}



Get cell ID based on particle position. 

Cell ID is uniquely given by (ny\+\_\+$\ast$nz\+\_\+)$\ast$ix + nz\+\_\+$\ast$iy + iz. Returns -\/1 if particle is not on grid. \hypertarget{class_grid_a93ea3ff4d2e7bdc9b5c4cbe9fe604f76}{}\label{class_grid_a93ea3ff4d2e7bdc9b5c4cbe9fe604f76} 
\index{Grid@{Grid}!get\+Field\+Interpolator\+Vec@{get\+Field\+Interpolator\+Vec}}
\index{get\+Field\+Interpolator\+Vec@{get\+Field\+Interpolator\+Vec}!Grid@{Grid}}
\subsubsection{\texorpdfstring{get\+Field\+Interpolator\+Vec()}{getFieldInterpolatorVec()}}
{\footnotesize\ttfamily int Grid\+::get\+Field\+Interpolator\+Vec (\begin{DoxyParamCaption}\item[{int}]{cell\+ID,  }\item[{double $\ast$}]{Interpolator\+Vec }\end{DoxyParamCaption})}



Return vector for field interpolation. 

Based on cell\+ID, return relevant edge E and face B fields and cell origin, in format \mbox{[}x, y, z, ... Ex( ix, iy, iz ), Ex( ix, iy+1,iz ), Ex( ix, iy+1, iz+1 ), Ex( ix, iy, iz+1 ), ... Ey( ix, iy, iz ), Ey( ix, iy, iz+1 ), Ey( ix+1, iy, iz+1 ), Ey( ix+1, iy, iz ), ... Ez( ix, iy, iz ), Ez( ix+1, iy, iz ), Ez( ix+1, iy+1, iz ), Ez( ix, iy+1, iz ), ... Bx( ix, iy, iz ), Bx( ix+1, iy, iz ), ... By( ix, iy, iz ), By( ix, iy+1, iz ), ... Bz( ix, iy, iz ), Bz( ix, iy, iz+1 ), ...\mbox{]} where ix, iy, and iz are the row indices for each of the three dimensions (calculated from the cell\+ID) \hypertarget{class_grid_a7c37daac383190622c7cf37597101510}{}\label{class_grid_a7c37daac383190622c7cf37597101510} 
\index{Grid@{Grid}!get\+Step\+Size@{get\+Step\+Size}}
\index{get\+Step\+Size@{get\+Step\+Size}!Grid@{Grid}}
\subsubsection{\texorpdfstring{get\+Step\+Size()}{getStepSize()}}
{\footnotesize\ttfamily double Grid\+::get\+Step\+Size (\begin{DoxyParamCaption}\item[{int}]{dimension }\end{DoxyParamCaption})}



Get number of cells along dimension in grid. 

Returns number of cells along dimension according to; dimension = 0\+: x dimension = 1\+: y dimension = 2\+: z Returns -\/1 if invalid dimension. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/grid/grid.\+hpp\item 
src/grid/grid.\+cpp\item 
src/grid/o\+Grid.\+cpp\item 
src/grid/spooky\+Grid.\+cpp\end{DoxyCompactItemize}
